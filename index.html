<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Digital Thaw | Water Footprint</title>
    
    <!-- PWA Settings -->
    <meta name="theme-color" content="#0B1026">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Digital Thaw">
    <meta name="application-name" content="Digital Thaw">
    
    <!-- Link to the Real Manifest File (Added ?v=2 to force update) -->
    <link rel="manifest" href="manifest.json?v=2">
    
    <!-- Standard Favicon (Browser Tab) - Kept as 192px -->
    <link rel="icon" type="image/png" href="192.png">
    
    <!-- iOS Icon (Home Screen) - Updated to 512px -->
    <link rel="apple-touch-icon" href="512.png">

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker registered!'))
                    .catch(err => console.log('Service Worker failed:', err));
            });
        }
    </script>

    <style>
        /* --- ANIMATIONS & SCROLLBAR --- */
        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(0); opacity: 1; }
            100% { transform: translateY(110vh) translateX(20px); opacity: 0.3; }
        }
        .animate-fall {
            animation: fall linear infinite;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.2s ease-out forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Custom Scrollbar */
        .ice-scroll::-webkit-scrollbar {
            width: 4px;
        }
        .ice-scroll::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 3px;
        }
        .ice-scroll::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
        }
        
        /* Prevent iOS zoom on inputs */
        input, button, select, textarea {
            font-size: 16px; 
        }
    </style>
</head>
<body class="bg-[#0B1026] text-slate-900 font-sans selection:bg-cyan-200 selection:text-cyan-900 overflow-x-hidden">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Data ---
        const ACTIVITY_TYPES = [
            { id: 'ai', label: 'AI Chat (LLMs)', rate: 0.042, icon: 'ph-robot', desc: 'Heavy compute cooling', unit: 'queries' },
            { id: 'aigen', label: 'AI Image', rate: 15.042, icon: 'ph-image', desc: 'Can be anywhere between 2-50L', unit: 'images' },
            { id: 'video_hd', label: 'Streaming (4K/HD)', rate: 0.75, icon: 'ph-film-strip', desc: 'High bandwidth server load', unit: 'min' },
            { id: 'game', label: 'Online Gaming', rate: 0.00018, icon: 'ph-game-controller', desc: 'Very little on the server', unit: 'min' },
            { id: 'social', label: 'Tiktok', rate: 0.270, icon: 'ph-thumbs-up', desc: 'Standard server requests', unit: 'min' },
            { id: 'Longersocials', label: 'Youtube Longforms', rate: 1.600, icon: 'ph-monitor-play', desc: '(20 mins)', unit: 'videos' },
            { id: 'Twitch', label: 'Twitch Streams', rate: 8.000, icon: 'ph-broadcast', desc: '(1h 30 mins)', unit: 'streams' },
            { id: 'music', label: 'Music Streaming', rate: 0.100, icon: 'ph-music-notes', desc: 'Lower bandwidth', unit: 'min' },
            { id: 'browsing', label: 'Google Searches', rate: 0.00026, icon: 'ph-globe', desc: 'Light server load', unit: 'searches' },
            { id: 'cleaning', label: 'Showering', rate: 12.0000, icon: 'ph-drop', desc: "Showers shouldn't take more than 10 mins", unit: 'min', isExtra: true },
            { id: 'flush', label: 'Toilet Flushes', rate: 9.5000, icon: 'ph-drop', desc: "Only Flush When You Need To", unit: 'amount', isExtra: true },
            { id: 'bath', label: 'Bath', rate: 95.5000, icon: 'ph-bathtub', desc: "Only Flush When You Need To", unit: 'amount', isExtra: true },
        ];

        const App = () => {
            // Load from localStorage or default to empty array
            const [entries, setEntries] = useState(() => {
                const saved = localStorage.getItem('digitalThawEntries');
                return saved ? JSON.parse(saved) : [];
            });

            const [selectedActivity, setSelectedActivity] = useState(ACTIVITY_TYPES[0].id);
            const [inputValue, setInputValue] = useState('');
            const [totalWater, setTotalWater] = useState(0);
            const [showExtras, setShowExtras] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [showHistory, setShowHistory] = useState(false);
            const [historyViewDay, setHistoryViewDay] = useState(null); // Tracks which day is clicked in history
            const [unit, setUnit] = useState('L'); 
            const [installPrompt, setInstallPrompt] = useState(null);

            // Save to localStorage whenever entries change
            useEffect(() => {
                localStorage.setItem('digitalThawEntries', JSON.stringify(entries));
            }, [entries]);

            // Filter entries for Today
            const todaysEntries = useMemo(() => {
                const now = new Date();
                const startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
                return entries.filter(entry => entry.id >= startOfDay);
            }, [entries]);

            // Calculate total based ONLY on today's entries
            useEffect(() => {
                const total = todaysEntries.reduce((acc, entry) => acc + entry.waterUsed, 0);
                setTotalWater(total);
            }, [todaysEntries]);

            // Listen for the install prompt
            useEffect(() => {
                const handler = (e) => {
                    e.preventDefault();
                    setInstallPrompt(e);
                };
                window.addEventListener('beforeinstallprompt', handler);
                return () => window.removeEventListener('beforeinstallprompt', handler);
            }, []);

            // History Calculation
            const historyStats = useMemo(() => {
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const dayOfWeek = today.getDay(); // 0 (Sun) to 6 (Sat)
                
                // Calculate Start of This Week (Sunday as start)
                const startOfThisWeek = new Date(today);
                startOfThisWeek.setDate(today.getDate() - dayOfWeek);
                startOfThisWeek.setHours(0,0,0,0);

                // Calculate Start of Last Week
                const startOfLastWeek = new Date(startOfThisWeek);
                startOfLastWeek.setDate(startOfThisWeek.getDate() - 7);
                
                let thisWeekTotal = 0;
                let lastWeekTotal = 0;
                const dailyTotals = [0, 0, 0, 0, 0, 0, 0]; // Sun - Sat

                entries.forEach(entry => {
                    const entryDate = new Date(entry.id);
                    // Reset time part for date comparison
                    const compareDate = new Date(entryDate.getFullYear(), entryDate.getMonth(), entryDate.getDate());

                    if (compareDate >= startOfThisWeek) {
                        thisWeekTotal += entry.waterUsed;
                        dailyTotals[entryDate.getDay()] += entry.waterUsed;
                    } else if (compareDate >= startOfLastWeek && compareDate < startOfThisWeek) {
                        lastWeekTotal += entry.waterUsed;
                    }
                });

                return { thisWeekTotal, lastWeekTotal, dailyTotals };
            }, [entries]);

            // Memoized entries for the specific day clicked in history
            const selectedDayEntries = useMemo(() => {
                if (historyViewDay === null) return [];
                
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const dayOfWeek = today.getDay(); 
                
                const startOfThisWeek = new Date(today);
                startOfThisWeek.setDate(today.getDate() - dayOfWeek);
                startOfThisWeek.setHours(0,0,0,0);
                
                const targetDate = new Date(startOfThisWeek);
                targetDate.setDate(startOfThisWeek.getDate() + historyViewDay);
                
                return entries.filter(entry => {
                    const entryDate = new Date(entry.id);
                    return entryDate.getDate() === targetDate.getDate() &&
                           entryDate.getMonth() === targetDate.getMonth() &&
                           entryDate.getFullYear() === targetDate.getFullYear();
                }).sort((a, b) => b.id - a.id); // Newest first
            }, [historyViewDay, entries]);

            const handleAdd = (e) => {
                e.preventDefault();
                if (!inputValue || inputValue <= 0) return;

                const activity = ACTIVITY_TYPES.find(a => a.id === selectedActivity);
                const water = parseFloat(inputValue) * activity.rate; 

                const newEntry = {
                    id: Date.now(),
                    activity: activity.label,
                    icon: activity.icon,
                    amount: parseFloat(inputValue),
                    unit: activity.unit,
                    waterUsed: water
                };

                setEntries([newEntry, ...entries]);
                setInputValue('');
            };

            const removeEntry = (id) => {
                setEntries(entries.filter(e => e.id !== id));
            };

            const formatWater = (liters) => {
                if (unit === 'gal') {
                    return (liters * 0.264172).toFixed(2);
                }
                return liters.toFixed(2);
            };

            const handleResetData = () => {
                if(confirm("Are you sure you want to wipe all history?")) {
                    setEntries([]); 
                    localStorage.removeItem('digitalThawEntries');
                    setShowSettings(false);
                }
            };

            const handleDownload = () => {
                if (installPrompt) {
                    installPrompt.prompt();
                    installPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            setInstallPrompt(null);
                        }
                    });
                } else {
                    const isLocal = window.location.protocol === 'file:';
                    if (isLocal) {
                         alert("⚠️ To install this app, please upload these files to a web server (like Netlify or GitHub Pages).");
                    } else {
                         alert("Tap your browser's 'Share' or 'Menu' button and select 'Add to Home Screen'.");
                    }
                }
            };

            // Snowflakes
            const [snowflakes, setSnowflakes] = useState([]);
            useEffect(() => {
                const flakes = Array.from({ length: 20 }).map((_, i) => ({
                    id: i,
                    left: `${Math.random() * 100}%`,
                    width: `${Math.random() * 5 + 3}px`,
                    height: `${Math.random() * 5 + 3}px`,
                    animationDuration: `${Math.random() * 10 + 5}s`,
                    animationDelay: `${Math.random() * 5}s`
                }));
                setSnowflakes(flakes);
            }, []);

            const ActivityButton = ({ type }) => (
                <button
                    key={type.id}
                    type="button"
                    onClick={() => setSelectedActivity(type.id)}
                    className={`flex items-center gap-2 rounded-xl border p-3 text-left transition-all duration-200 active:scale-95 ${
                        selectedActivity === type.id
                        ? 'bg-blue-500/30 border-blue-300 shadow-[0_0_15px_rgba(59,130,246,0.5)]'
                        : 'bg-white/5 border-transparent hover:bg-white/10'
                    }`}
                >
                    <i className={`text-xl text-white ${type.icon}`}></i>
                    <span className="text-xs font-semibold text-white leading-tight">{type.label}</span>
                </button>
            );

            // Split activities
            const mainActivities = ACTIVITY_TYPES.filter(type => !type.isExtra);
            const extraActivities = ACTIVITY_TYPES.filter(type => type.isExtra);
            const currentActivity = ACTIVITY_TYPES.find(a => a.id === selectedActivity);

            return (
                <div className="relative min-h-screen w-full">
                    
                    {/* Fixed Background Layer */}
                    <div className="fixed inset-0 z-0">
                        <div className="absolute inset-0 bg-gradient-to-b from-[#0B1026] via-[#2B32B2] to-[#E3FDFD]"></div>
                        {snowflakes.map((flake) => (
                            <div
                                key={flake.id}
                                className="absolute bg-white rounded-full opacity-80 pointer-events-none animate-fall"
                                style={{
                                    top: '-10px',
                                    left: flake.left,
                                    width: flake.width,
                                    height: flake.height,
                                    animationDuration: flake.animationDuration,
                                    animationDelay: flake.animationDelay
                                }}
                            ></div>
                        ))}
                    </div>

                    {/* --- History Modal --- */}
                    {showHistory && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in" onClick={() => setShowHistory(false)}>
                            <div className="bg-[#1a2342] border border-white/20 w-full max-w-md rounded-2xl p-6 shadow-2xl overflow-y-auto max-h-[90vh]" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-xl font-bold text-white flex items-center gap-2">
                                        <i className="ph-fill ph-clock-counter-clockwise text-cyan-400"></i> History
                                    </h2>
                                    <button onClick={() => setShowHistory(false)} className="text-blue-200 hover:text-white transition-colors">
                                        <i className="ph-bold ph-x text-xl"></i>
                                    </button>
                                </div>

                                <div className="grid grid-cols-2 gap-4 mb-6">
                                    <div className="bg-blue-500/20 rounded-xl p-4 text-center border border-blue-400/30">
                                        <div className="text-xs text-blue-200 uppercase tracking-wider mb-1">This Week</div>
                                        <div className="text-2xl font-bold text-white">{formatWater(historyStats.thisWeekTotal)} <span className="text-sm font-normal">{unit}</span></div>
                                    </div>
                                    <div className="bg-white/5 rounded-xl p-4 text-center border border-white/10">
                                        <div className="text-xs text-blue-200 uppercase tracking-wider mb-1">Last Week</div>
                                        <div className="text-2xl font-bold text-gray-300">{formatWater(historyStats.lastWeekTotal)} <span className="text-sm font-normal">{unit}</span></div>
                                    </div>
                                </div>

                                <div className="bg-white/5 rounded-xl p-4 border border-white/10">
                                    <h3 className="text-sm text-blue-200 mb-4 font-semibold">Current Week Breakdown</h3>
                                    <div className="flex items-end justify-between h-32 gap-2">
                                        {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day, index) => {
                                            const val = historyStats.dailyTotals[index];
                                            const max = Math.max(...historyStats.dailyTotals, 1); // Avoid div by zero
                                            const height = (val / max) * 100;
                                            
                                            return (
                                                <div 
                                                    key={day} 
                                                    onClick={() => setHistoryViewDay(index)}
                                                    className={`flex flex-col items-center flex-1 h-full justify-end group cursor-pointer p-1 rounded-lg transition-colors ${historyViewDay === index ? 'bg-white/10' : 'hover:bg-white/5'}`}
                                                >
                                                    <div className={`w-full rounded-t-sm relative transition-all duration-500 ${historyViewDay === index ? 'bg-cyan-400 shadow-[0_0_10px_rgba(34,211,238,0.5)]' : 'bg-cyan-900/50'}`} style={{height: `${Math.max(height, 5)}%`}}>
                                                        {historyViewDay !== index && (
                                                            <div className="absolute bottom-0 left-0 w-full bg-cyan-400/80 rounded-t-sm transition-all duration-500 h-full opacity-0 group-hover:opacity-100"></div>
                                                        )}
                                                        {/* Tooltip */}
                                                        <div className="absolute -top-8 left-1/2 -translate-x-1/2 bg-black text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-20">
                                                            {formatWater(val)} {unit}
                                                        </div>
                                                    </div>
                                                    <div className={`text-[10px] mt-2 font-medium ${historyViewDay === index ? 'text-white' : 'text-blue-300'}`}>{day}</div>
                                                </div>
                                            )
                                        })}
                                    </div>

                                    {/* Detailed breakdown when day is clicked */}
                                    {historyViewDay !== null && (
                                        <div className="mt-4 pt-4 border-t border-white/10 animate-fade-in">
                                            <h4 className="text-blue-200 text-xs uppercase tracking-wider font-bold mb-3">
                                                {['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][historyViewDay]} Details
                                            </h4>
                                            <div className="space-y-2 max-h-40 overflow-y-auto pr-1 ice-scroll">
                                                {selectedDayEntries.length === 0 ? (
                                                    <div className="text-center text-blue-300/40 text-xs italic py-2">No activity recorded</div>
                                                ) : (
                                                    selectedDayEntries.map(entry => (
                                                        <div key={entry.id} className="flex justify-between items-center bg-black/20 p-2 rounded text-xs border border-white/5">
                                                            <div className="flex items-center gap-2">
                                                                <div className="w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center">
                                                                    <i className={`ph-fill ${entry.icon} text-cyan-400`}></i>
                                                                </div>
                                                                <span className="text-white">{entry.activity}</span>
                                                            </div>
                                                            <div className="text-right">
                                                                <div className="text-cyan-300 font-bold">{formatWater(entry.waterUsed)} {unit}</div>
                                                                <div className="text-[10px] text-blue-300/50">{entry.amount} {entry.unit}</div>
                                                            </div>
                                                        </div>
                                                    ))
                                                )}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* --- Settings Modal --- */}
                    {showSettings && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in" onClick={() => setShowSettings(false)}>
                            <div className="bg-[#1a2342] border border-white/20 w-full max-w-sm rounded-2xl p-6 shadow-2xl" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-xl font-bold text-white">Settings</h2>
                                    <button onClick={() => setShowSettings(false)} className="text-blue-200 hover:text-white transition-colors">
                                        <i className="ph-bold ph-x text-xl"></i>
                                    </button>
                                </div>

                                <div className="space-y-4">
                                    <div className="bg-white/5 p-4 rounded-xl flex justify-between items-center">
                                        <div className="flex items-center gap-3">
                                            <i className="ph-fill ph-ruler text-cyan-400 text-xl"></i>
                                            <span className="text-white font-medium">Units</span>
                                        </div>
                                        <div className="flex bg-black/30 rounded-lg p-1">
                                            <button 
                                                onClick={() => setUnit('L')}
                                                className={`px-3 py-1 rounded-md text-sm font-bold transition-all ${unit === 'L' ? 'bg-blue-500 text-white shadow-lg' : 'text-blue-200 hover:text-white'}`}
                                            >
                                                Liters
                                            </button>
                                            <button 
                                                onClick={() => setUnit('gal')}
                                                className={`px-3 py-1 rounded-md text-sm font-bold transition-all ${unit === 'gal' ? 'bg-blue-500 text-white shadow-lg' : 'text-blue-200 hover:text-white'}`}
                                            >
                                                Gallons
                                            </button>
                                        </div>
                                    </div>

                                    <button 
                                        onClick={handleResetData}
                                        className="w-full bg-white/5 hover:bg-red-500/20 hover:border-red-500/50 border border-transparent p-4 rounded-xl flex items-center gap-3 transition-all group"
                                    >
                                        <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center group-hover:bg-red-500 text-white">
                                            <i className="ph-bold ph-trash"></i>
                                        </div>
                                        <div className="text-left">
                                            <div className="text-white font-medium group-hover:text-red-200">Reset Data</div>
                                            <div className="text-xs text-blue-300/50 group-hover:text-red-300/70">Wipe all history</div>
                                        </div>
                                    </button>

                                    <button 
                                        onClick={handleDownload}
                                        className="w-full bg-gradient-to-r from-cyan-900/50 to-blue-900/50 hover:from-cyan-800 hover:to-blue-800 border border-cyan-500/30 p-4 rounded-xl flex items-center gap-3 transition-all"
                                    >
                                        <div className="w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center text-cyan-300">
                                            <i className="ph-bold ph-download-simple"></i>
                                        </div>
                                        <div className="text-left">
                                            <div className="text-white font-medium">Download App</div>
                                            <div className="text-xs text-blue-300/50">Add to Home Screen</div>
                                        </div>
                                    </button>
                                </div>
                                
                                <div className="mt-6 text-center text-xs text-blue-300/30">
                                    Version 1.2.0 • Digital Thaw
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Main Content */}
                    <div className="relative z-10 flex min-h-screen items-center justify-center p-4 md:p-6 overflow-y-auto">
                        <div className="w-full max-w-4xl overflow-hidden rounded-3xl bg-white/10 shadow-2xl backdrop-blur-xl border border-white/20 flex flex-col md:flex-row ring-1 ring-white/30 my-4 md:my-0">
                        
                            {/* LEFT PANEL */}
                            <div className="relative flex flex-col justify-center border-b border-white/20 p-6 md:p-8 md:w-1/2 md:border-b-0 md:border-r bg-white/5 md:bg-transparent">
                                
                                {/* Top Right Buttons */}
                                <div className="absolute top-6 right-6 flex gap-2 z-20">
                                    <button 
                                        onClick={() => setShowHistory(true)}
                                        className="p-2 rounded-full bg-white/5 hover:bg-white/10 text-cyan-200 hover:text-white transition-all border border-transparent hover:border-cyan-400/30"
                                        title="History"
                                    >
                                        <i className="ph-fill ph-clock-counter-clockwise text-xl"></i>
                                    </button>
                                    <button 
                                        onClick={() => setShowSettings(true)}
                                        className="p-2 rounded-full bg-white/5 hover:bg-white/10 text-blue-200 hover:text-white transition-all border border-transparent hover:border-white/20"
                                        title="Settings"
                                    >
                                        <i className="ph-fill ph-gear text-xl"></i>
                                    </button>
                                </div>

                                <h1 className="mb-2 text-3xl md:text-4xl font-bold tracking-wide text-transparent bg-clip-text bg-gradient-to-r from-white to-blue-200 drop-shadow-sm pr-20">
                                    Digital Thaw
                                </h1>
                                <p className="mb-6 md:mb-8 text-sm font-light text-blue-100 leading-relaxed">
                                    Data centers drink water to stay cool. Check your daily digital water footprint.
                                </p>

                                <form onSubmit={handleAdd} className="space-y-4 md:space-y-5">
                                    <div>
                                        <div className="flex justify-between items-end mb-2">
                                            <label className="block text-sm font-medium text-blue-200">Activity Type</label>
                                        </div>
                                        
                                        <div className="grid grid-cols-2 gap-2 transition-all duration-300">
                                            {mainActivities.map(type => <ActivityButton key={type.id} type={type} />)}
                                            {showExtras && extraActivities.map(type => <ActivityButton key={type.id} type={type} />)}
                                        </div>

                                        <button 
                                            type="button" 
                                            onClick={() => setShowExtras(!showExtras)}
                                            className="mt-3 text-xs font-bold text-cyan-300 hover:text-cyan-200 flex items-center gap-1 transition-colors ml-1"
                                        >
                                            {showExtras ? (
                                                <><i className="ph-bold ph-caret-up"></i> Show Less</>
                                            ) : (
                                                <><i className="ph-bold ph-caret-down"></i> Show More Options</>
                                            )}
                                        </button>
                                    </div>

                                    <div>
                                        <label className="mb-2 block text-sm font-medium text-blue-200">
                                            {currentActivity.unit === 'min' ? 'Duration (Minutes)' : 'Quantity (Amount)'}
                                        </label>
                                        <div className="relative">
                                            <input
                                                type="number"
                                                min="1"
                                                inputMode="numeric" 
                                                value={inputValue}
                                                onChange={(e) => setInputValue(e.target.value)}
                                                placeholder={currentActivity.unit === 'min' ? "e.g. 60" : "e.g. 10"}
                                                className="w-full rounded-xl border border-white/20 bg-white/10 p-4 text-base text-white placeholder-blue-300/50 transition-all focus:border-blue-300 focus:outline-none focus:ring-1 focus:ring-blue-300 appearance-none"
                                            />
                                            <span className="absolute right-4 top-4 font-bold text-blue-200 uppercase text-xs tracking-wider pt-1">
                                                {currentActivity.unit}
                                            </span>
                                        </div>
                                    </div>

                                    <button
                                        type="submit"
                                        className="w-full rounded-xl bg-gradient-to-r from-cyan-400 to-blue-500 py-4 font-bold text-slate-900 shadow-lg transition-transform hover:-translate-y-1 active:translate-y-0 active:scale-95 hover:from-cyan-300 hover:to-blue-400"
                                    >
                                        Add to Impact
                                    </button>
                                </form>
                            </div>

                            {/* RIGHT PANEL */}
                            <div className="flex flex-col bg-black/20 p-6 md:p-8 md:w-1/2 min-h-[400px] md:min-h-auto">
                                <div className="group relative mb-6 overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-6 text-center">
                                    <div className="absolute left-0 top-0 h-1 w-full bg-gradient-to-r from-transparent via-cyan-400 to-transparent opacity-50"></div>
                                    <h2 className="mb-1 text-xs md:text-sm uppercase tracking-widest text-blue-200">Total Water Estimate</h2>
                                    <div className="mb-2 text-4xl md:text-5xl font-bold text-white drop-shadow-[0_0_15px_rgba(100,200,255,0.4)]">
                                        {formatWater(totalWater)} <span className="text-xl md:text-2xl text-blue-300">{unit}</span>
                                    </div>
                                    <div className="flex items-center justify-center gap-2 text-sm text-blue-200">
                                        <i className="ph-fill ph-drop text-cyan-400"></i>
                                        <span>≈ {Math.ceil(totalWater * 2)} bottles (500ml)</span>
                                    </div>
                                </div>

                                <h3 className="mb-4 border-b border-white/10 pb-2 text-sm font-semibold text-blue-200">Today's Usage Log</h3>

                                <div className="ice-scroll flex-1 space-y-3 overflow-y-auto pr-2" style={{ maxHeight: '300px' }}>
                                    {todaysEntries.length === 0 ? (
                                        <div className="flex h-full flex-col items-center justify-center text-blue-300/50 italic py-8">
                                            <i className="ph ph-snowflake mb-2 text-4xl animate-spin" style={{ animationDuration: '10s' }}></i>
                                            <p>No activity recorded yet.</p>
                                        </div>
                                    ) : (
                                        todaysEntries.map((entry) => (
                                            <div
                                                key={entry.id}
                                                className="group flex items-center justify-between rounded-xl border border-white/5 bg-white/5 p-3 md:p-4 transition-colors hover:bg-white/10"
                                            >
                                                <div className="flex items-center gap-3">
                                                    <div className="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-blue-500/20 text-cyan-300">
                                                        <i className={`text-xl ${entry.icon}`}></i>
                                                    </div>
                                                    <div className="overflow-hidden">
                                                        <div className="font-semibold text-white truncate">{entry.activity}</div>
                                                        <div className="text-xs text-blue-200">
                                                            {entry.amount} {entry.unit}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div className="flex items-center gap-3 md:gap-4 shrink-0">
                                                    <div className="text-right">
                                                        <div className="font-bold text-cyan-300">
                                                            {formatWater(entry.waterUsed)} {unit}
                                                        </div>
                                                    </div>
                                                    <button
                                                        onClick={() => removeEntry(entry.id)}
                                                        className="flex h-8 w-8 items-center justify-center rounded-full text-white/50 hover:bg-red-500/20 hover:text-red-400 md:opacity-0 md:group-hover:opacity-100 transition-all"
                                                        aria-label="Remove entry"
                                                    >
                                                        <i className="ph-bold ph-x"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>

                                <div className="mt-6 text-center text-[10px] text-blue-300/40">
                                    *Estimates based on approximate Data Center Water Usage Effectiveness (WUE) metrics.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
